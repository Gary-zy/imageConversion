# OFD 预览组件 - 完整包说明

## 📦 包结构

```
ofd-preview-component/
├── 📄 README.md              # 完整的使用文档（API 文档、功能说明）
├── 📄 QUICKSTART.md          # 快速开始指南（3 步上手）
├── 📄 INTEGRATION.md         # 集成指南（如何在项目中集成）
├── 📄 example.tsx            # 使用示例代码
├── 📄 package.json           # npm 包配置文件
│
├── 📁 src/                   # 源代码目录
│   ├── 📄 index.ts           # 主入口文件（导出所有组件和工具）
│   │
│   ├── 📁 components/        # React 组件
│   │   ├── OfdPreview.tsx    # 预览组件（只负责预览）
│   │   └── OfdProcessor.tsx  # 完整处理组件（上传+预览+转换）
│   │
│   ├── 📁 utils/             # 工具类
│   │   └── OfdConverter.ts   # OFD 转换器类（核心逻辑）
│   │
│   ├── 📁 core/              # OFD 核心库
│   │   ├── ofd.js            # OFD 主文件
│   │   ├── ofd_parser.js     # OFD 解析器
│   │   ├── ofd_render.js     # OFD 渲染器
│   │   ├── ofd_util.js       # OFD 工具函数
│   │   ├── pipeline.js       # 流水线处理
│   │   ├── sm3.js            # SM3 加密算法
│   │   ├── ses_signature_parser.js       # 签名解析
│   │   ├── verify_signature_util.js      # 签名验证
│   │   └── 📁 jbig2/          # JBIG2 解码库
│   │       ├── arithmetic_decoder.js
│   │       ├── ccitt.js
│   │       ├── compatibility.js
│   │       ├── core_utils.js
│   │       ├── is_node.js
│   │       ├── jbig2.js
│   │       ├── jbig2_stream.js
│   │       ├── primitives.js
│   │       ├── stream.js
│   │       └── util.js
│   │
│   └── 📁 types/             # TypeScript 类型定义
│       └── index.ts          # 所有类型定义
```

## 🚀 快速使用（3 步）

### 1️⃣ 复制组件到项目

```bash
cp -r ofd-preview-component /your-project/src/lib/
```

### 2️⃣ 安装依赖

```bash
npm install jszip jspdf file-saver html2canvas
```

### 3️⃣ 使用组件

```tsx
import { OfdProcessor } from './lib/ofd-preview-component';

function App() {
  return <OfdProcessor />;
}
```

## 📚 文档说明

| 文档 | 用途 | 适合人群 |
|------|------|----------|
| **README.md** | 完整的功能介绍和 API 文档 | 想深入了解所有功能的开发者 |
| **QUICKSTART.md** | 3 步快速上手指南 | 想快速集成组件的开发者 |
| **INTEGRATION.md** | 详细的集成指南 | 需要在不同框架/项目中集成的开发者 |
| **example.tsx** | 实际代码示例 | 喜欢通过代码学习的开发者 |

## 🎯 核心组件

### 1. OfdProcessor（推荐）

完整的 OFD 处理组件，包含：
- ✅ 文件上传（拖拽 + 点击选择）
- ✅ 文档预览
- ✅ 格式转换（PNG/JPEG/WebP/PDF）
- ✅ 页面导航
- ✅ 缩放控制
- ✅ 转换设置

**使用：**
```tsx
<OfdProcessor />
```

### 2. OfdPreview

仅预览组件，适合只需要预览功能的场景。

**使用：**
```tsx
<OfdPreview
  converter={converter}
  currentPage={0}
  onPageChange={(page) => setCurrentPage(page)}
  scale={1}
  onScaleChange={(scale) => setScale(scale)}
/>
```

### 3. OfdConverter

工具类，提供编程式 API。

**使用：**
```tsx
const converter = new OfdConverter();
await converter.loadOfd(file);
const images = await converter.convertToImage({ ... });
const pdf = await converter.convertToPdf({ ... });
```

## 🎨 功能特性

| 功能 | 说明 |
|------|------|
| OFD 预览 | 支持 OFD 文档在线预览 |
| 页面导航 | 上一页/下一页/跳转到指定页 |
| 缩放控制 | 50% - 300% 可调 |
| 转 PNG | 支持单页或多页转换 |
| 转 JPEG | 支持质量调节（1-100） |
| 转 WebP | 支持质量调节（1-100） |
| 转 PDF | 支持 A4/A3/原始尺寸，纵向/横向 |
| 页面范围 | 全部页/当前页/自定义页面 |
| 拖拽上传 | 支持拖拽文件上传 |
| 进度显示 | 实时显示加载和转换进度 |
| 纯前端 | 无需服务器，保护隐私 |

## 📋 依赖项

```json
{
  "dependencies": {
    "jszip": "^3.10.1",      // 打包多文件为 ZIP
    "jspdf": "^2.5.1",       // 生成 PDF
    "file-saver": "^2.0.5",  // 保存文件
    "html2canvas": "^1.4.1"  // HTML 转 Canvas
  }
}
```

## 🔧 集成方式

### 方式 1: 直接复制（推荐）

最简单，直接复制到项目中使用。

### 方式 2: 本地 npm 包

在 package.json 中添加：
```json
{
  "dependencies": {
    "ofd-preview-component": "file:./ofd-preview-component"
  }
}
```

### 方式 3: 发布到 npm

可以将组件发布到 npm 供其他项目使用。

## 💡 使用场景

| 场景 | 推荐组件 |
|------|----------|
| 完整的 OFD 转换工具 | OfdProcessor |
| 只需要预览功能 | OfdPreview |
| 需要自定义转换逻辑 | OfdConverter |
| 集成到现有系统 | OfdPreview + OfdConverter |
| 独立的转换页面 | OfdProcessor |

## 🎓 学习路径

1. **新手**: 先看 `QUICKSTART.md`，3 步上手
2. **进阶**: 再看 `README.md`，了解完整功能
3. **高级**: 最后看 `INTEGRATION.md`，学习如何集成

## ⚠️ 注意事项

1. **文件大小**: 默认最大支持 50MB 的 OFD 文件
2. **浏览器**: 需要现代浏览器（Chrome、Firefox、Safari、Edge）
3. **样式**: 组件使用 Tailwind CSS，需要项目已配置
4. **性能**: 大文件转换时建议显示进度提示
5. **隐私**: 所有处理都在浏览器本地完成

## 🐛 常见问题

**Q: 样式不生效？**
A: 确保项目配置了 Tailwind CSS

**Q: 找不到模块？**
A: 检查导入路径是否正确

**Q: 转换很慢？**
A: 正常现象，OFD 解析和渲染需要时间

**Q: 内存占用高？**
A: 高分辨率转换会增加内存使用，这是正常的

## 📞 获取帮助

1. 查看文档：README.md、QUICKSTART.md、INTEGRATION.md
2. 查看示例：example.tsx
3. 检查类型定义：src/types/index.ts
4. 查看控制台错误信息

## ✅ 完成！

现在你有一个完整的、独立的 OFD 预览组件包，可以轻松集成到任何 React 项目中！

祝使用愉快！ 🎉
